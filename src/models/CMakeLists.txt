include(cc_library)
include(cc_test)

cc_library(
  NAME 
    models
  HDRS 
    llama2.h
  SRCS 
  DEPS
    :input_parameters
    :model_args
    :layers
    :memory
    glog::glog
    torch
)

cc_test(
  NAME
    models_test
  SRCS
    llama2_test.cpp
  DEPS
    :models
    :state_dict
    GTest::gtest_main
)

cc_library(
  NAME 
    causal_lm
  HDRS 
    causal_lm.h
  SRCS
    causal_lm.cpp 
  DEPS
    :models
    glog::glog
    torch
)

cc_library(
  NAME 
    model_args
  HDRS 
    model_args.h
  SRCS 
    model_args.cpp
  DEPS
    torch
    nlohmann_json::nlohmann_json
)

cc_library(
  NAME 
    input_parameters
  HDRS 
    parameters.h
  SRCS 
  DEPS
    torch
)
