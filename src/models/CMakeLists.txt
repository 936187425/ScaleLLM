include(cc_library)
include(cc_test)

cc_library(
  NAME 
    models
  HDRS
    model_registry.h
    input_parameters.h 
    llama.h
    huggingface/llama.h
    huggingface/gpt2.h
    huggingface/gpt_neox.h
    huggingface/mistral.h
    huggingface/aquila.h
    huggingface/mpt.h
    huggingface/qwen.h
    huggingface/internlm.h
    causal_lm.h
  SRCS
    model_registry.cpp
    causal_lm.cpp
  DEPS
    :model_args
    :layers
    :memory
    glog::glog
    torch
)

cc_test(
  NAME
    models_test
  SRCS
    llama_test.cpp
    huggingface/mpt_test.cpp
  DEPS
    :models
    :state_dict
    GTest::gtest_main
)

cc_library(
  NAME 
    model_args
  HDRS 
    args.h
  SRCS
  DEPS
    :common
)
