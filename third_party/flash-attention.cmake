include(cc_library)

cc_library(
  NAME 
    flash-attention.custom_ops
  SRCS
    flash-attention/csrc/flash_attn/flash_api.cpp
    flash-attention/csrc/flash_attn/src/flash_fwd_hdim32_fp16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_fwd_hdim32_bf16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_fwd_hdim64_fp16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_fwd_hdim64_bf16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_fwd_hdim96_fp16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_fwd_hdim96_bf16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_fwd_hdim128_fp16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_fwd_hdim128_bf16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_fwd_hdim160_fp16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_fwd_hdim160_bf16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_fwd_hdim192_fp16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_fwd_hdim192_bf16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_fwd_hdim224_fp16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_fwd_hdim224_bf16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_fwd_hdim256_fp16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_fwd_hdim256_bf16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_bwd_hdim32_fp16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_bwd_hdim32_bf16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_bwd_hdim64_fp16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_bwd_hdim64_bf16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_bwd_hdim96_fp16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_bwd_hdim96_bf16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_bwd_hdim128_fp16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_bwd_hdim128_bf16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_bwd_hdim160_fp16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_bwd_hdim160_bf16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_bwd_hdim192_fp16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_bwd_hdim192_bf16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_bwd_hdim224_fp16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_bwd_hdim224_bf16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_bwd_hdim256_fp16_sm80.cu
    flash-attention/csrc/flash_attn/src/flash_bwd_hdim256_bf16_sm80.cu
  DEPS
    ${TORCH_LIBRARIES}
    Python::Python
)
